From ball%seal.witchcraft.com@witchcraft.com Mon Feb  3 00:10:44 1992
Received: from fernwood.mpk.ca.us by immd4.informatik.uni-erlangen.de  with SMTP (5.64+/7.3a-FAU)
	id AA21761; Mon, 3 Feb 92 00:10:27 +0100
Received: by fernwood.mpk.ca.us; id AA12001; Sun, 2 Feb 92 15:10:21 -0800
Received: by witchcraft.com (5.61/3.2.083191-)
	id AA05564; Sun, 2 Feb 92 13:58:35 -0800
From: ball%seal.witchcraft.com@witchcraft.com (Allen D. Ball)
Received: by seal.witchcraft.com (5.61/3.2.083191-)
	id AA08776; Sun, 2 Feb 92 13:45:05 -0800
Message-Id: <9202022145.AA08776@seal.witchcraft.com>
Subject: ISC patches to Screen 3.1.6
To: jnweiger@immd4.informatik.uni-erlangen.de (Juergen Weigert)
Date: Sun, 2 Feb 92 13:45:02 PST
X-Mailer: ELM [version 2.3 PL11]
Status: OR

Here are the ISC patches to screen 3.1.6.  There was a bit of a muff
in config/config.isc and <sys/types.h> must be included before
<signal.h> in screen.c.

The detach/attach behavior is still the same.  Screen is sitting on a
select() with a (struct timeval *) NULL argument.  As soon as there is
any input the first process detaches and the second attaches.

                                        Allen
-- 
Allen D. Ball           ball@witchcraft.com
2025 Clement St #3, San Francisco, CA 94121



*** config/config.dst	Sun Jan 26 17:40:13 1992
--- config/config.isc	Thu Jan 30 22:43:24 1992
***************
*** 44,47 ****
  #define REMOTE_DETACH
  #define POW_DETACH
  #define NETHACK 
! #define ETCSCREENRC "/usr/local/etc/screenrc" */
--- 44,50 ----
  #define REMOTE_DETACH
  #define POW_DETACH
  #define NETHACK 
! #define ETCSCREENRC "/usr/local/etc/screenrc"
! #ifdef _POSIX_SOURCE
! #define KILLSTUFF_DECLARED
! #endif

*** screen.c.dst	Sun Jan 26 17:50:24 1992
--- screen.c	Thu Jan 30 23:00:50 1992
***************
*** 37,43 ****
  
  
  #include <sys/param.h>
- #include <signal.h>
  #include <ctype.h>
  #include <pwd.h>
  #include <fcntl.h>
--- 37,42 ----
***************
*** 58,63 ****
--- 57,65 ----
  #include <sys/select.h> /* for timeval */
  #endif
  #include <sys/types.h>
+ #ifdef ISC
+ #include <sys/bsdtypes.h>
+ #endif
  #if !defined(sysV68) && !defined(M_XENIX)
  # include <sys/wait.h>
  #endif
***************
*** 67,72 ****
--- 69,76 ----
  # include <sys/ioctl.h>
  #endif /* sun */
  
+ #include <signal.h>
+ 
  #include "config.h"
  
  #ifdef SVR4
***************
*** 483,489 ****
   *  First, close all unused descriptors
   *  (otherwise, we might have problems with the select() call)
   */
! #ifdef SYSV
    for (n = NOFILE - 1; n > 2; n--)
      close(n);
  #else
--- 487,493 ----
   *  First, close all unused descriptors
   *  (otherwise, we might have problems with the select() call)
   */
! #if defined(SYSV) && !defined(ISC)
    for (n = NOFILE - 1; n > 2; n--)
      close(n);
  #else

